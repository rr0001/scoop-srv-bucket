{
    "version": "2.5.1",
    "description": "HTTP/2 web server with automatic HTTPS",
    "homepage": "https://caddyserver.com",
    "license": "Apache-2.0",
    "architecture": {
        "64bit": {
            "url": "https://github.com/caddyserver/caddy/releases/download/v2.5.1/caddy_2.5.1_windows_amd64.zip",
            "hash": "sha512:4294796c4bd4bed0c593d83606a5413de30f35f88d624e1b1e5b6cd8672ffbcc7a689d7ce4ef30c1abea0e95eda62220faac15d2a6aca0c3e2b418abe7a74118"
        }
    },
    "bin": "caddy.exe",
    "depends": "nssm",
    "env_set": {
        "CADDYFILE": "$dir\\Caddyfile"
    },
    "pre_install": [
        "$ini = \"$dir\\Caddyfile\"",
        "if (!(Test-Path \"$ini\")) {",
        "   Add-Content -Path \"$ini\" -Value \"http://localhost {`n`troot * /Projects/www/localhost`n`tphp_fastcgi 127.0.0.1:9081`n`tfile_server`n}\" -Encoding Ascii",
        "}"
    ],
    "persist": "Caddyfile",
    "post_install": [
        "# Install as windows service",
        "nssm install caddy \"$dir\\caddy.exe\" \"run --config=$dir\\Caddyfile\"",
        "nssm set caddy AppEnvironmentExtra PHP_FCGI_CHILDREN=4 PHP_FCGI_MAX_REQUESTS=10000",
        "nssm start caddy"
    ],
    "uninstaller": {
        "script": "$null = nssm remove caddy confirm"
    },
    "notes": [
        "Caddy has been installed as a Windows Service with NSSM: caddy",
        "",
        "To start/stop the service: `nssm start caddy`, nssm stop caddy",
        "",
        "Edit the caddy config file: sudo notepad $dir\\Caddyfile"
    ],
    "checkver": {
        "github": "https://github.com/caddyserver/caddy"
    },
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/caddyserver/caddy/releases/download/v$version/caddy_$version_windows_amd64.zip"
            }
        },
        "hash": {
            "url": "$baseurl/caddy_$version_checksums.txt"
        }
    }
}
